<!DOCTYPE html>
<html>
<head>
<script>
    function openTab(event, tabName) {
      // Hide all tables
      document.querySelectorAll('.table').forEach(tab => {
        tab.style.display = 'none';
      });

      // Show the selected tab content
      let activeTab = document.getElementById(tabName);
      if (activeTab) {
        activeTab.style.display = 'block';
        document.body.setAttribute('data-active-tab', tabName);
      }
    }

    window.onload = function () {
      openTab(new Event('load'), 'Problems');
    };

    function search() {
      let input, filter, table, tr, td, i, txtValue;
      input = document.getElementById("search");
      filter = input.value.toUpperCase();
      if(document.body.getAttribute('data-active-tab') === 'Problems') {
        table = document.getElementById("problems-table");
      } else {
        table = document.getElementById("discussions-table");
      }
      tr = table.getElementsByTagName("tr");
      for (i = 0; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[0];
        if (td) {
          txtValue = td.textContent || td.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }
      }
    }

</script>

  <link rel="stylesheet" href="{{url_for('static', filename='css/homepage.css')}}">
  <title>Home Page</title>
</head>


{%include 'banner.html'%}

<body>
  
  <!-- Content -->
   <div class="intro">
        <h1>Welcome to Lxndria</h1>
        <p>Here you can post problems and discussions for others to see and help you with. You can also help others by answering their questions and discussing topics with them.</p>
  </div>
  
  <!---PROBLEMS TABLE---->
  <div class="Table">

    {%include 'main_table_header.html'%}
    <div class ="table" id="Problems">

    <table id="problems-table">

      <tr>
        <th>Problem</th>
        <th>Topic</th>
        <th>Difficulty</th>
        <th>Posted On</th>
      </tr>
      {% for index in range(page*row_per_page, (page+1)*row_per_page) %}
      {% if index >= problems|length %}
        {% set stop=true %}
      {% else %}
        {% set problem = problems[index] %}
      
      <tr>
        <td><a href="/problem/{{problem.id}}">{{problem.title}}</a></td>
        <td>{{problem.topic}}</td>
        <td>{{problem.difficulty}}</td>
        <td>{{problem.created_at.strftime('%B %d, %Y')}}</td>
      </tr>
      {% endif %}
      {% endfor %}
    </table>
    <div class="pagination">
      {% if page > 0 %}
        <a href="/?page={{page-1}}">Previous</a>
      {% endif %}
      {% if not stop %}
        <a href="/?page={{page+1}}">Next</a>
      {% endif %}
  </div>
  </div>


  <!----DISCUSSION TABLE----->

  <div class="table" id="Discussions" style="display: none;">
    <table id="discussions-table">

    
      <tr>
        <th>Title</th>
        <th>Author</th>
        <th>Posted On</th>
      </tr>
      {% for index in range(page*row_per_page, (page+1)*row_per_page) %}
      {% if index >= discussions|length %}
        {% set stop=true %}
      {% else %}
        {% set discussion = discussions[index] %}
      
      <tr>
        <td><a href="/discussion/{{discussion.id}}">{{discussion.title}}</a></td>
        <td>{{discussion.user.name}}</td>
        <td>{{discussion.created_at.strftime('%B %d, %Y')}}</td>
      </tr>
      {% endif %}
      {% endfor %}
    </table>
    <div class="pagination">
      {% if page > 0 %}
        <a href="/?page={{page-1}}">Previous</a>
      {% endif %}
      {% if not stop %}
        <a href="/?page={{page+1}}">Next</a>
      {% endif %}
  </div>
  </div>

  {%include 'flash.html'%}
</div>
</body>
</html>